pinstallpgmpy
importnumpyasnp
importpandasas pd
frompgmpy.estimatorsimportMaximumLikelihoodEstimator
frompgmpy.modelsimportDiscreteBayesianNetwork
frompgmpy.inferenceimportVariableElimination
heartDisease=pd.read_csv("heart.csv")
heartDisease=heartDisease.replace('?',np.nan)
print('Sampleinstancesfromthedatasetare:')
print(heartDisease.head())
model=DiscreteBayesianNetwork([
('age','heartdisease'),
('sex','heartdisease'),
('exang','heartdisease'),
('cp','heartdisease'),
('heartdisease','restecg'),
('heartdisease','chol')
])
model.fit(heartDisease,estimator=MaximumLikelihoodEstimator)
print('Inferencing withBayesianNetwork')
infer=VariableElimination(model)
print('1.ProbabilityofHeartDiseasegivenevidence=restecg')
q1=infer.query(variables=['heartdisease'],evidence={'restecg':1})
print(q1)
print('2.ProbabilityofHeartDiseasegivenevidence=cp')
q2=infer.query(variables=['heartdisease'],evidence={'cp':2})
print(q2)