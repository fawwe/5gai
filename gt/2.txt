ipinstallwittgensteinpandasscikit-learn
importpandasas pd
importwittgensteinaslw
fromsklearn.model_selectionimporttrain_test_split
fromsklearn.metricsimportaccuracy_score
df=pd.read_csv("playtennis.csv")
ifdf['PlayTennis'].dtype==object:
df['PlayTennis']=df['PlayTennis'].map({'Yes':True,'No':False})
train,test=train_test_split(df,test_size=0.2,random_state=42)
ripper_clf=lw.RIPPER(random_state=42,verbosity=0)
ripper_clf.fit(train,class_feat='PlayTennis',pos_class=True)
print("LearnedRIPPERRules:")
print(ripper_clf.ruleset_)
X_test=test.drop('PlayTennis',axis=1)
y_test=test['PlayTennis']
predictions=['Yes'ifp else'No'forp inripper_clf.predict(X_test)]
y_test_labels=['Yes'ifyelse'No'foryiny_test]
accuracy=accuracy_score(y_test_labels,predictions)
print(f"Accuracyontestset:{accuracy:.2f}")
print("\nDetailedRuleSetAnalysis:")
ripper_clf.out_model()
importpandasas pd
importwittgensteinaslw
fromsklearn.model_selectionimporttrain_test_split
fromsklearn.metricsimportaccuracy_score,classification_report,confusion_matrix
df=pd.read_csv("mushrooms.csv")
df['class']=df['class'].map({'e':False,'p':True})
train,test=train_test_split(df,test_size=0.3,random_state=42)
ripper_clf=lw.RIPPER(random_state=42,verbosity=0)
ripper_clf.fit(train,class_feat='class',pos_class=True)
print("LearnedRIPPERRules:")
print(ripper_clf.ruleset_)
X_test=test.drop('class',axis=1)
y_test=test['class']
predictions=ripper_clf.predict(X_test)
accuracy=accuracy_score(y_test,predictions)
print(f"\nAccuracyontestset:{accuracy:.4f}")
print("\nDetailedRuleSetAnalysis:")
ripper_clf.out_model()
print("\nConfusionMatrix:")
print(confusion_matrix(y_test,predictions))
print("\nClassificationReport:")
print(classification_report(y_test,predictions,target_names=["Edible","Poisonous"]))